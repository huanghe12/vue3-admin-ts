import{_ as R,c as q,g as M,i as P,h as O,j as W,k as X,l as Y}from"./index.2323aac0.js";import{d as I,N as V,r as j,R as z,e as c,f as w,j as S,w as t,h as U,k as e,i as a,g as N,P as G,T as H,X as J,m as E,E as b,o as K,V as L,Y as Q,W as Z,t as ee,l as te}from"./vendor.9dd18d83.js";const ae=["src"],le={class:"btn-wrap"},ue=E("\u53D6\u6D88"),oe=E("\u786E\u5B9A"),se=I({props:{getSwipers:Function},setup(y,{expose:D}){const l=y,m=V(),r=j({swiperData:{carouselId:"",carouselUrl:"",redirectUrl:"",carouselRank:""},rules:{carouselUrl:[{required:!0,message:"\u56FE\u7247\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],carouselRank:[{required:!0,message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]},title:"\u6DFB\u52A0\u8F6E\u64AD\u56FE",visable:!1}),v=u=>{r.visable=!0,u?(r.title="\u4FEE\u6539\u8F6E\u64AD\u56FE",r.swiperData.carouselId=u,h(u)):(r.title="\u6DFB\u52A0\u8F6E\u64AD\u56FE",r.swiperData={carouselId:"",carouselUrl:"",redirectUrl:"",carouselRank:""})},h=async u=>{const s=await P(u),{data:p}=s;r.swiperData={carouselId:p.carouselId,carouselUrl:p.carouselUrl,redirectUrl:p.redirectUrl,carouselRank:p.carouselRank}},C=u=>{const s=u.name.lastIndexOf("."),p=u.name.slice(s+1);if(!["jpg","png","jpeg"].includes(p))return b.error("\u8BF7\u4E0A\u4F20 jpg/png/jpeg \u683C\u5F0F\u7684\u56FE\u7247"),!1},k=u=>{r.swiperData.carouselUrl=u.data,b.success("\u4E0A\u4F20\u6210\u529F")},d=()=>{var u;(u=m.value)==null||u.validate(async s=>{if(s){if(O(r.swiperData.redirectUrl)){b.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");return}await W(r.swiperData.carouselId?"put":"post",r.swiperData),b.success(r.swiperData.carouselId?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),r.visable=!1,l.getSwipers&&l.getSwipers()}})},n=()=>{var u;(u=m.value)==null||u.resetFields()};D({open:v});const{title:_,visable:F,swiperData:i,rules:A}=z(r);return(u,s)=>{const p=c("el-icon"),o=c("el-upload"),f=c("el-form-item"),x=c("el-input"),B=c("el-button"),$=c("el-dialog");return w(),S($,{modelValue:a(F),"onUpdate:modelValue":s[3]||(s[3]=g=>J(F)?F.value=g:null),title:a(_),width:"400px",onClose:n},{footer:t(()=>[U("div",le,[e(B,{onClick:s[2]||(s[2]=g=>F.value=!1)},{default:t(()=>[ue]),_:1}),e(B,{class:"btn",onClick:d},{default:t(()=>[oe]),_:1})])]),default:t(()=>[e(a(H),{ref:(g,T)=>{T.formRef=g,m.value=g},model:a(i),rules:a(A),"label-position":"right","label-width":"85px"},{default:t(()=>[e(f,{label:"\u56FE\u7247\uFF1A",prop:"carouselUrl"},{default:t(()=>[e(o,{class:"avatar-uploader",accept:"jpg, jpeg, png","show-file-list":!1,action:a(q),headers:{token:a(M)("token")},"before-upload":C,"on-success":k},{default:t(()=>[a(i).carouselUrl?(w(),N("img",{key:0,src:a(i).carouselUrl,alt:"\u56FE\u7247",style:{width:"200px",height:"100px",border:"1px solid #e9e9e9"}},null,8,ae)):(w(),S(p,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[e(a(G))]),_:1}))]),_:1},8,["action","headers"])]),_:1}),e(f,{label:"\u8DF3\u8F6C\u94FE\u63A5\uFF1A"},{default:t(()=>[e(x,{modelValue:a(i).redirectUrl,"onUpdate:modelValue":s[0]||(s[0]=g=>a(i).redirectUrl=g)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u6392\u5E8F\u503C\uFF1A",prop:"carouselRank"},{default:t(()=>[e(x,{modelValue:a(i).carouselRank,"onUpdate:modelValue":s[1]||(s[1]=g=>a(i).carouselRank=g),type:"number"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});var re=R(se,[["__scopeId","data-v-79b69e1e"]]);const ne=E(" \u65B0\u589E "),ie=E("\u6279\u91CF\u5220\u9664"),ce=["src"],de=["href"],pe=E("\u4FEE\u6539"),_e=E("\u5220\u9664"),ge=I({setup(y){const D=V(),l=j({pageNumber:1,pageSize:10,total:0,loading:!1,list:[],multipleSelection:[]}),m=async()=>{l.loading=!0;const d={pageNumber:l.pageNumber,pageSize:l.pageSize},{data:n}=await X(d);l.list=n.list,l.total=n.totalCount,l.loading=!1};K(()=>{m()});const r=d=>{l.multipleSelection=d},v=d=>{D.value.open(d)},h=async d=>{let n;if(d)n={ids:[d]};else{if(!l.multipleSelection.length){b.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u9009\u9879");return}n={ids:l.multipleSelection.map(_=>_.carouselId)}}try{await Y(n),b.success("\u5220\u9664\u6210\u529F"),m()}catch(_){}},{list:C,loading:k}=z(l);return(d,n)=>{const _=c("el-button"),F=c("el-popconfirm"),i=c("el-table-column"),A=c("el-table"),u=c("el-pagination"),s=c("el-card"),p=L("loading");return w(),N(Q,null,[e(s,{class:"swiper-container"},{header:t(()=>[e(_,{type:"primary",icon:"el-icon-plus",size:"small",class:"add-btn",onClick:n[0]||(n[0]=o=>v())},{default:t(()=>[ne]),_:1}),e(F,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:h},{reference:t(()=>[e(_,{type:"danger",icon:"el-icon-delete",size:"small",class:"del-btn"},{default:t(()=>[ie]),_:1})]),_:1})]),default:t(()=>[Z(e(A,{data:a(C),style:{width:"100%"},onSelectionChange:r},{default:t(()=>[e(i,{type:"selection",width:"55"}),e(i,{label:"\u8F6E\u64AD\u56FE",width:"200",align:"center"},{default:t(({row:o})=>[U("img",{src:o.carouselUrl,alt:"\u8F6E\u64AD\u56FE"},null,8,ce)]),_:1}),e(i,{label:"\u8DF3\u8F6C\u94FE\u63A5",align:"center"},{default:t(({row:o})=>[U("a",{target:"_blank",href:o.redirectUrl},ee(o.redirectUrl),9,de)]),_:1}),e(i,{label:"\u6392\u5E8F\u503C",align:"center",width:"120",prop:"carouselRank"}),e(i,{label:"\u6DFB\u52A0\u65F6\u95F4",align:"center",width:"200",prop:"createTime"}),e(i,{label:"\u64CD\u4F5C",align:"center"},{default:t(({row:o})=>[e(_,{type:"text",onClick:f=>v(o.carouselId)},{default:t(()=>[pe]),_:2},1032,["onClick"]),e(F,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:f=>h(o.carouselId)},{reference:t(()=>[e(_,{type:"text"},{default:t(()=>[_e]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),[[p,a(k)]]),a(l).total>10?(w(),S(u,{key:0,"current-page":a(l).pageNumber,"onUpdate:current-page":n[1]||(n[1]=o=>a(l).pageNumber=o),"page-size":a(l).pageSize,"onUpdate:page-size":n[2]||(n[2]=o=>a(l).pageSize=o),background:"",layout:"prev, pager, next",total:a(l).total,onCurrentChange:m},null,8,["current-page","page-size","total"])):te("",!0)]),_:1}),e(re,{ref:(o,f)=>{f.dialogRef=o,D.value=o},"get-swipers":m},null,512)],64)}}});var fe=R(ge,[["__scopeId","data-v-b379a8be"]]);export{fe as default};
