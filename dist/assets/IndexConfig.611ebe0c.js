import{h as V,n as $,o as j,_ as M,p as K,q as W}from"./index.2323aac0.js";import{d as U,N as B,r as T,R as h,e as f,f as S,j as X,w as u,k as e,i as a,T as Y,X as k,m as F,E as C,u as G,K as H,o as J,V as L,g as O,Y as P,W as Q,h as Z,t as ee}from"./vendor.9dd18d83.js";const oe=F("\u53D6\u6D88"),te=F("\u786E\u5B9A"),ne=U({props:{queryIndexConfig:Function,configType:Number},setup(R,{expose:v}){const b=R,m=B(),r=T({title:"",visible:!1,formData:{configId:"",configType:b.configType,configName:"",redirectUrl:"",goodsId:"",configRank:""},rules:{configName:[{required:!0,message:"\u5546\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],goodsId:[{required:!0,message:"\u5546\u54C1\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],configRank:[{required:!0,message:"\u6392\u5E8F\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),i=async s=>{const{data:o}=await j(s);r.formData={configId:o.configId,configType:o.configType,configName:o.configName,redirectUrl:o.redirectUrl,goodsId:o.goodsId,configRank:o.configRank}},p=async s=>{if(r.visible=!0,r.title=s?"\u4FEE\u6539\u5546\u54C1":"\u6DFB\u52A0\u5546\u54C1",s)return i(s);r.formData={configId:"",configType:b.configType,configName:"",redirectUrl:"",goodsId:"",configRank:""}},I=()=>{var s;(s=m.value)==null||s.validate(async o=>{if(o){if(V(r.formData.configName)||V(r.formData.redirectUrl))return C.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");if(r.formData.configName.length>128)return C.error("\u5546\u54C1\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7128\u4E2A\u5B57\u7B26");if(Number(r.formData.configRank)<0||Number(r.formData.configRank)>200)return C.error("\u6392\u5E8F\u503C\u4E0D\u80FD\u5C0F\u4E8E 0 \u6216\u5927\u4E8E 200");await $(r.formData,r.formData.configId?"put":"post"),C.success(r.formData.configId?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),r.visible=!1,b.queryIndexConfig()}})},D=()=>{var s;(s=m.value)==null||s.resetFields()};v({open:p});const{title:y,visible:_,formData:d,rules:A}=h(r);return(s,o)=>{const l=f("el-input"),n=f("el-form-item"),g=f("el-button"),E=f("el-dialog");return S(),X(E,{modelValue:a(_),"onUpdate:modelValue":o[5]||(o[5]=t=>k(_)?_.value=t:null),title:a(y),width:"400px",onClose:D},{footer:u(()=>[e(g,{onClick:o[4]||(o[4]=t=>_.value=!1)},{default:u(()=>[oe]),_:1}),e(g,{type:"primary",onClick:I},{default:u(()=>[te]),_:1})]),default:u(()=>[e(a(Y),{ref:(t,x)=>{x.formRef=t,m.value=t},model:a(d),"label-position":"right","label-width":"100px",rules:a(A)},{default:u(()=>[e(n,{label:"\u5546\u54C1\u540D\u79F0\uFF1A",prop:"configName"},{default:u(()=>[e(l,{modelValue:a(d).configName,"onUpdate:modelValue":o[0]||(o[0]=t=>a(d).configName=t)},null,8,["modelValue"])]),_:1}),e(n,{label:"\u8DF3\u8F6C\u94FE\u63A5\uFF1A",prop:"redirectUrl"},{default:u(()=>[e(l,{modelValue:a(d).redirectUrl,"onUpdate:modelValue":o[1]||(o[1]=t=>a(d).redirectUrl=t)},null,8,["modelValue"])]),_:1}),e(n,{label:"\u5546\u54C1\u7F16\u53F7\uFF1A",prop:"goodsId"},{default:u(()=>[e(l,{modelValue:a(d).goodsId,"onUpdate:modelValue":o[2]||(o[2]=t=>a(d).goodsId=t),type:"number"},null,8,["modelValue"])]),_:1}),e(n,{label:"\u6392\u5E8F\u503C\uFF1A",prop:"configRank"},{default:u(()=>[e(l,{modelValue:a(d).configRank,"onUpdate:modelValue":o[3]||(o[3]=t=>a(d).configRank=t),type:"number"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});const ue=F("\u589E\u52A0"),ae=F("\u6279\u91CF\u5220\u9664"),le=["href"],re=F("\u4FEE\u6539"),ie=F("\u5220\u9664"),se=U({setup(R){const v=G(),{name:b}=H(),m={hot:3,new:4,recommend:5},r=B(),i=T({loading:!1,tableData:[],pageNumber:1,pageSize:10,configType:m[b],total:0,multipleSelection:[]});v.beforeEach(l=>{i.configType=m[l.name],i.pageNumber=1,p()}),J(()=>{p()});const p=async()=>{i.loading=!0;const{data:l}=await K({params:{pageNumber:i.pageNumber,pageSize:i.pageSize,configType:i.configType}});i.tableData=l.list,i.total=l.totalCount,i.loading=!1},I=l=>{i.multipleSelection=l.map(n=>n.configId)},D=async l=>{if(!l&&!i.multipleSelection.length)return C.error("\u8BF7\u9009\u62E9\u9879");const n={ids:l?[l]:i.multipleSelection};try{await W(n),C.success("\u5220\u9664\u6210\u529F"),p()}catch(g){console.error(g.message)}},y=l=>{var n;(n=r.value)==null||n.open(l)},{loading:_,tableData:d,total:A,pageSize:s,pageNumber:o}=h(i);return(l,n)=>{const g=f("el-button"),E=f("el-popconfirm"),t=f("el-table-column"),x=f("el-table"),z=f("el-pagination"),q=f("el-card"),w=L("loading");return S(),O(P,null,[e(q,{class:"hot-container"},{header:u(()=>[e(g,{type:"primary",size:"small",icon:"el-icon-plus",onClick:n[0]||(n[0]=c=>y())},{default:u(()=>[ue]),_:1}),e(E,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:n[1]||(n[1]=c=>D())},{reference:u(()=>[e(g,{type:"danger",size:"small",icon:"el-icon-delete"},{default:u(()=>[ae]),_:1})]),_:1})]),default:u(()=>[Q(e(x,{data:a(d),onSelectionChange:I},{default:u(()=>[e(t,{type:"selection"}),e(t,{label:"\u5546\u54C1\u540D\u79F0",prop:"configName",align:"center"}),e(t,{label:"\u8DF3\u8F6C\u94FE\u63A5",align:"center"},{default:u(({row:c})=>[Z("a",{href:c.redirectUrl,target:"_blank"},ee(c.redirectUrl),9,le)]),_:1}),e(t,{label:"\u6392\u5E8F\u503C",prop:"configRank",align:"center"}),e(t,{label:"\u5546\u54C1\u7F16\u53F7",prop:"goodsId",align:"center"}),e(t,{label:"\u6DFB\u52A0\u65F6\u95F4",prop:"createTime",align:"center"}),e(t,{label:"\u64CD\u4F5C",align:"center"},{default:u(({row:c})=>[e(g,{type:"text",onClick:N=>y(c.configId)},{default:u(()=>[re]),_:2},1032,["onClick"]),e(E,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:N=>D(c.configId)},{reference:u(()=>[e(g,{type:"text"},{default:u(()=>[ie]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),[[w,a(_)]]),e(z,{"page-size":a(s),"onUpdate:page-size":n[2]||(n[2]=c=>k(s)?s.value=c:null),"current-page":a(o),"onUpdate:current-page":n[3]||(n[3]=c=>k(o)?o.value=c:null),background:"",layout:"prev, pager, next",total:a(A),onCurrentChange:p},null,8,["page-size","current-page","total"])]),_:1}),e(ne,{ref:(c,N)=>{N.dialogRef=c,r.value=c},"query-index-config":p,"config-type":a(i).configType},null,8,["config-type"])],64)}}});var fe=M(se,[["__scopeId","data-v-76e2bb8d"]]);export{fe as default};
